<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:viewModels="clr-namespace:HojozatyCode.ViewModels;assembly=HojozatyCode"
             x:Class="HojozatyCode.Pages.NotificationsPage"
             x:DataType="viewModels:NotificationsViewModel"
             Shell.NavBarIsVisible="True"
             Shell.TabBarIsVisible="False"
             BackgroundColor="#F9F6FC">

    <ContentPage.BindingContext>
        <viewModels:NotificationsViewModel />
    </ContentPage.BindingContext>

    <Grid RowDefinitions="Auto,*">

        <!-- Header -->
        <Grid Grid.Row="0"
              Padding="20,10"
              BackgroundColor="White"
              ColumnDefinitions="Auto,*">
            <Label Text="Notifications"
                   FontSize="24"
                   FontAttributes="Bold"
                   TextColor="#4F378A"
                   VerticalOptions="Center"
                   HorizontalOptions="Start" />
        </Grid>

        <!-- Notifications List -->
        <CollectionView Grid.Row="1"
                        ItemsSource="{Binding Notifications}"
                        Margin="16,10">
            <CollectionView.ItemTemplate>
                <DataTemplate>
                    <Border Stroke="{x:Null}" BackgroundColor="LightGray" StrokeShape="RoundRectangle 10" Margin="0,0,0,10" Padding="12">
                        <Grid ColumnDefinitions="Auto,Auto,*,Auto" RowDefinitions="Auto">

                            <!-- Status Dot -->
                            <Ellipse Fill="{Binding StatusColor}"
                                     HeightRequest="10"
                                     WidthRequest="10"
                                     VerticalOptions="Center"
                                     Margin="0,0,8,0"/>

                            <!-- Icon -->
                            <Image Grid.Column="1"
                                   Source="{Binding IconSource}"
                                   HeightRequest="28"
                                   WidthRequest="28"
                                   VerticalOptions="Center"
                                   Margin="0,0,12,0"/>

                            <!-- Title & Subtitle -->
                            <VerticalStackLayout Grid.Column="2" Spacing="2" VerticalOptions="Center">
                                <Label Text="{Binding Title}"
                                       FontAttributes="Bold"
                                       FontSize="16"
                                       TextColor="Black"/>
                                <Label Text="{Binding Subtitle}"
                                       FontSize="13"
                                       TextColor="Gray"/>
                            </VerticalStackLayout>

                            <!-- Timestamp -->
                            <Frame Grid.Column="3"
                                   Padding="6,2"
                                   BackgroundColor="#E0E0E0"
                                   CornerRadius="12"
                                   HasShadow="False"
                                   VerticalOptions="Start"
                                   HorizontalOptions="End">
                                <Label Text="{Binding Timestamp, StringFormat='{0:h:mm tt}'}"
                                       FontSize="12"
                                       TextColor="Gray"
                                       HorizontalOptions="Center"
                                       VerticalOptions="Center"/>
                            </Frame>

                            <!-- Tap Gesture -->
                            <Grid.GestureRecognizers>
                                <TapGestureRecognizer 
                                    Command="{Binding Source={RelativeSource AncestorType={x:Type ContentPage}}, Path=BindingContext.NotificationTappedCommand}"
                                    CommandParameter="{Binding}" />
                            </Grid.GestureRecognizers>
                        </Grid>
                    </Border>
                </DataTemplate>
            </CollectionView.ItemTemplate>
        </CollectionView>
    </Grid>
</ContentPage>
